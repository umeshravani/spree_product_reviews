<tr id="<%= dom_id(product_review) %>">
  <td class="w-10 cursor-pointer" data-action="click->row-link#openLink">
    <% if product_review.approved? %>
      <span class="badge badge-shipped">
        <i class="ti ti-check"></i> Approved
      </span>
    <% elsif product_review.approved == false %>
      <span class="badge badge-canceled">
        <i class="ti ti-x"></i> Disapproved
      </span>
    <% else %>
      <span class="badge badge-pending">
        <i class="ti ti-progress"></i> Pending
      </span>
    <% end %>
  </td>

  <td><%= product_review.user&.email || "Guest" %></td>
  <td><%= product_review.title %></td>
  <td><%= product_review.rating %></td>
  <td><%= l(product_review.created_at, format: :short) %></td>
  <td>
    <% if product_review.images.attached? %>
      <div data-controller="lightbox" class="flex gap-1">
        <% product_review.images.each do |img| %>
          <% next unless img.blob.present? %>
          <% thumb = img.variant(resize_to_limit: [50, 50], saver: { quality: 70 }) %>

          <%= link_to main_app.rails_blob_path(img, only_path: true),
                      data: {
                        pswp_width: img.blob.metadata[:width]  || 2000,
                        pswp_height: img.blob.metadata[:height] || 2000
                      },
                      class: "inline-block rounded border border-gray-200 admin-review-thumb" do %>
            <%= image_tag main_app.rails_representation_path(thumb, only_path: true),
                          width: 50,
                          height: 50,
                          class: "rounded",
                          loading: "lazy",
                          decoding: "async" %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </td>

  <td class="actions">
    <% if product_review.approved? %>
      <%= button_to "Disapprove",
            disapprove_admin_product_product_review_path(
              product_review.product,
              product_review
            ),
            method: :get,
            class: "btn btn-warning btn-sm mr-2" %>
    <% else %>
      <%= link_to Spree.t(:approve),
            approve_admin_product_product_review_path(
              product_review.product,
              product_review
            ),
            method: :get,
            class: "btn btn-success btn-sm mr-2" %>
    <% end %>

<% if can? :edit, product_review %>
  <%= link_to_edit(
    product_review,
    no_text: true,
    url: edit_admin_product_product_review_path(
      product_review.product,
      product_review,
      return_to: request.fullpath
    )
  ) %>
<% end %>

    <% if can? :destroy, product_review %>
      <%= link_to_delete(
            product_review,
            url: admin_product_product_review_path(
              product_review.product,
              product_review
            ),
            no_text: true
          ) %>
    <% end %>
  </td>
</tr>